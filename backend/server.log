+ exec gosu vibecode scripts/start --hot
Installing dependencies and generating Prisma client...
[0.03ms] ".env"
bun install v1.2.19 (aad3abea)

$ prisma generate
Environment variables loaded from .env
Prisma schema loaded from prisma/schema.prisma

‚úî Generated Prisma Client (v6.17.1) to ./generated/prisma in 187ms

Start by importing your Prisma Client (See: https://pris.ly/d/importing-client)

Tip: Interested in query caching in just a few lines of code? Try Accelerate today! https://pris.ly/tip-3-accelerate


Checked 807 installs across 747 packages (no changes) [1.61s]
Starting server in dev mode with hot reload...
$ NODE_ENV=development bun run --hot src/index.ts
Failed to find Response internal state key
‚úÖ Environment variables validated successfully
üìÅ [Upload] Uploads directory exists: /home/user/workspace/backend/uploads
üîß Initializing Hono application...
üìÅ Serving static files from uploads/ directory
üîê Mounting phone auth routes at /api/auth
üì§ Mounting upload routes at /api/upload
üë• Mounting users routes at /api/users
üí¨ Mounting chats routes at /api/chats
üéüÔ∏è  Mounting invite routes at /api/invite
üí¨ Mounting messages routes at /api/messages
ü§ñ Mounting AI routes at /api/ai
‚öôÔ∏è  Mounting group settings routes at /api/group-settings
üëç Mounting reactions routes at /api/reactions
‚ö° Mounting custom commands routes at /api/custom-commands
üîó Mounting link preview routes at /api/link-preview
üîñ Mounting bookmarks routes at /api/bookmarks
ü§ñ Mounting AI friends routes at /api/ai-friends
üßµ Mounting threads routes at /api/threads
üìÖ Mounting events routes at /api/events
üé® Mounting reactor routes at /api/reactor
‚ö° Mounting catchup routes at /api/catchup
‚öôÔ∏è  Starting server...
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìç Environment: development
üöÄ Server is running on port 3000
üîó Base URL: http://localhost:3000
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üìö Available endpoints:
  üîê Auth:     /api/auth/*
  üì§ Upload:   POST /api/upload/image
  üë• Users:    GET/POST/PATCH /api/users
  üí¨ Chats:    GET/POST/PATCH/DELETE /api/chats
  üéüÔ∏è  Invite:   GET/POST /api/invite/:token
  üí¨ Messages: GET/POST /api/messages
  ü§ñ AI:       POST /api/ai/chat
  üñºÔ∏è  Avatar:   POST /api/ai/generate-group-avatar
  ‚öôÔ∏è  Settings: GET/PATCH /api/group-settings
  üëç Reactions: POST/DELETE /api/reactions
  ‚ö° Commands: GET/POST/PATCH/DELETE /api/custom-commands
  üîó Link Preview: POST /api/link-preview/fetch
  üîñ Bookmarks: GET/POST/DELETE /api/bookmarks
  üîî Notifications: POST /api/chats/:chatId/read-receipts
  üîî Unread Counts: GET /api/chats/unread-counts

  üåü AI Super Features:
  üßµ Threads:  GET/POST/PATCH/DELETE /api/threads
  üìÖ Events:   GET/POST/PATCH /api/events
  üé® Reactor:  POST /api/reactor/*
  ‚ö° Catch-Up: GET/POST /api/catchup

  üíö Health:   GET /health
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

[AI Engagement] Starting AI engagement service...
[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)
      at startAIEngagementService (/home/user/workspace/backend/src/services/ai-engagement.ts:455:3)
      at <anonymous> (/home/user/workspace/backend/src/index.ts:141:3)
      at <anonymous> (/home/user/workspace/backend/node_modules/@hono/node-server/dist/index.mjs:444:26)
      at emit (node:events:101:22)
      at emitListeningNextTick (node:_http_server:345:14)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

[AI Engagement] Error in polling loop: 420 |  * Main polling loop - checks all active chats for new messages
421 |  */
422 | export async function pollForEngagement() {
423 |   try {
424 |     // Get all chats that have at least one AI friend with engagement enabled
425 |     const chatsWithAIFriends = await db.aIFriend.findMany({
                                              ^
TypeError: undefined is not an object (evaluating 'db.aIFriend.findMany')
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:425:41)
      at pollForEngagement (/home/user/workspace/backend/src/services/ai-engagement.ts:422:40)

